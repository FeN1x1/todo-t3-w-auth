import type { NextPage } from "next";
import { useState } from "react";
import Head from "next/head";
import Input from "../components/Input";
import { trpc } from "../utils/trpc";
import List from "../components/List";

const Home: NextPage = () => {
  const create = trpc.todo.create.useMutation();
  const getAll = trpc.todo.getAll.useQuery();

  const [input, setInput] = useState<string>("");

  // const mutateTest = trpc.example.writeOne.useMutation();

  const handleOnChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setInput(e.target.value);
  };

  const handleOnClick = () => {
    if (input !== "") {
      create.mutate({ text: input });
      getAll.refetch();
      setInput("");
    }
  };

  return (
    <>
      <Head>
        <title>Create T3 App TODO</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Input
        value={input}
        handleOnChange={handleOnChange}
        handleOnClick={handleOnClick}
      />
      <List todos={getAll?.data} />
    </>
  );
};

export default Home;
